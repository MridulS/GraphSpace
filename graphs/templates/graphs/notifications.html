{% extends 'base.html' %}
{% block content %}
{% load staticfiles %}
<script type="text/javascript" src="{% static 'graphs/js/notifications.js' %}"></script>

{% if uid != None %}

<br>
<div class="row"><button style="position: relative;
   right: 100px; float: right;" class="btn btn-default read_notification" uid="{{ uid }}" allid="True">Mark all notifications as read</button></div>
<br>

<div class="row">
  <div class="col-sm-3">
    <div class="panel panel-primary">
      <div class="panel-heading">
        Groups
      </div>
      <div class="panel-body">
        <p>Notifications</p>
      </div>
      <table class="table">
        {% for group in groups_for_user %}
          <tr>
            <td><a href="{% url 'notifications' uid %}{{ group.groupId }}">{{ group.groupId }}</a></td>
          </tr>
        {% endfor %}
      </table>
    </div>
  </div>

<div class="col-sm-8">
{% if notifications != None %}
{% if check_new_notifications == True %}
{% for group, events in notifications.items %}
  {% if events != None %}
  <div class="panel panel-primary">
    <table class="table" id="notification_table">
      <tr bgcolor="#428BCA">
        <th><font color="white">{{ group }}</font></th>
        <th></th>
        <th><a href="#" data-toggle="tooltip" title="Mark all {{ group }} notifications as read" data-placement="left"><button class="btn btn-default read_notification" uid="{{ uid }}" gid="{{ group }}"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></button></a> </th>
      </tr>
      {% for event in events %}
        {% if event.owner_id != uid %}
          {% if event.is_active == 1 %}
            <tr id="{{ event.id }}" class="info"> 
              <td> <a href="{% url 'graphs' %}/{{ event.owner_id }}/{{ event.graph_id}}">{{ event.owner_id }} shared {{ event.graph_id }} with {{ event.group_id }}.</a></td>
              <td> Shared on {{ event.share_time }}</td>
              <td><a href="#" data-toggle="tooltip" title="Mark as read" data-placement="left"><button class="btn btn-default read_notification" nid="{{ event.id }}" uid="{{ event.member_id }}"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></button></a></td>
            </tr>
          {% endif %}
        {% endif %}
      {% endfor %}
  {% endif %}
  </table>
  </div>
{% endfor %}

</div>


{% else %}
<div class="panel panel-primary">
  <div class="panel-heading">
    <h4 class="panel-title" style="text-align: center">No new notifications.</h4>
  </div>
</div>
</div> 
{% endif %}
{% else %}
<div class="col-sm-8">

<!-- <div class="column"> -->
<div class="panel panel-primary">
  <div class="panel-heading">
    <h3 class="panel-title">{{ group }}</h3>
  </div>
  <table class="table">
  {% for event in all_events_in_group %}
  {% if event.owner_id != uid %}
    <tr> 
    <td> <a href="{% url 'graphs' %}/{{ event.owner_id }}/{{ event.graph_id}}">{{ event.owner_id }} shared {{ event.graph_id }} with {{ event.group_id }}.</td>
    </tr>
  {% endif %}
  {% endfor %}

  </table>
</div>

</div>

</div>
{% endif %}

{% endif %}
{% endblock %}